<ci:SettingsPageBase
    x:Class="SuperAutoBackup.AdvancedBackupSettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:ci="http://classisland.tech/schemas/xaml/core"
    mc:Ignorable="d"
    d:DesignHeight="600" d:DesignWidth="800">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="24,16,24,24" MaxWidth="800">

            <!-- 卡片 1：自动备份总开关 -->
            <Border Background="{DynamicResource CardBackgroundBrush}"
                    CornerRadius="4"
                    Padding="16"
                    Margin="0,0,0,12">
                <StackPanel>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <ci:IconText Grid.Column="0"
                                     Kind="AutoFix"
                                     Margin="0,0,12,0"
                                     VerticalAlignment="Center"/>

                        <StackPanel Grid.Column="1">
                            <TextBlock Text="启用自动备份"
                                       FontWeight="SemiBold"
                                       FontSize="16"/>
                            <TextBlock Text="启动 ClassIsland 时自动压缩并备份"
                                       FontSize="12"
                                       Opacity="0.7"/>
                        </StackPanel>

                        <ToggleButton Grid.Column="2"
                                      IsChecked="{Binding Enabled}"
                                      Style="{StaticResource MaterialDesignSwitchToggleButton}"
                                      VerticalAlignment="Center"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- 卡片 2：保留份数 -->
            <Border Background="{DynamicResource CardBackgroundBrush}"
                    CornerRadius="4"
                    Padding="16"
                    Margin="0,0,0,12">
                <StackPanel>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <ci:IconText Grid.Column="0"
                                     Kind="Counter"
                                     Margin="0,0,12,0"
                                     VerticalAlignment="Center"/>

                        <StackPanel Grid.Column="1">
                            <TextBlock Text="自动备份上限"
                                       FontWeight="SemiBold"
                                       FontSize="16"/>
                            <TextBlock Text="达到上限后自动删除最旧的备份"
                                       FontSize="12"
                                       Opacity="0.7"/>
                        </StackPanel>

                        <TextBox Grid.Column="2"
                                 Text="{Binding MaxBackups, UpdateSourceTrigger=PropertyChanged}"
                                 Width="60"
                                 HorizontalContentAlignment="Center"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- 卡片 3：目标路径 -->
            <Border Background="{DynamicResource CardBackgroundBrush}"
                    CornerRadius="4"
                    Padding="16"
                    Margin="0,0,0,12">
                <StackPanel>
                    <TextBlock Text="备份保存位置"
                               FontWeight="SemiBold"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <TextBox Text="{Binding TargetPath, UpdateSourceTrigger=PropertyChanged}"
                             Width="500"
                             HorizontalAlignment="Left"/>
                </StackPanel>
            </Border>

            <!-- 卡片 4：手动备份 -->
            <Border Background="{DynamicResource CardBackgroundBrush}"
                    CornerRadius="4"
                    Padding="16">
                <StackPanel>
                    <TextBlock Text="手动备份"
                               FontWeight="SemiBold"
                               FontSize="16"
                               Margin="0,0,0,8"/>
                    <WrapPanel>
                        <Button Content="立即备份"
                                Style="{StaticResource MaterialDesignFlatButton}"
                                Click="BtnBackupNow_Click"
                                Margin="0,0,12,0"/>
                        <Button Content="查看备份文件…"
                                Style="{StaticResource MaterialDesignFlatButton}"
                                Click="BtnOpenFolder_Click"/>
                    </WrapPanel>
                </StackPanel>
            </Border>

        </StackPanel>
    </ScrollViewer>
</ci:SettingsPageBase>